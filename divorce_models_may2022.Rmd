---
title: "Divorce Models"
output: html_document
---

```{r, echo=F, message=F, warning=F}
library(tidyverse)
library(haven)
library(sjmisc)
library(gridExtra)
library(sjPlot)
library(ggplot2)
library(ggpubr)


setwd("~/UPF PhD/Divorce/GGP/")
d <- readRDS("wave1_cleaned.rds")

d$long_mobility <- relevel(as.factor(d$long_mobility), ref = "immobile")

```

## Effect of Long Mobility (5 categories) on Divorce

DV = Divorce (binary)

IV = Long Mobility (5 categories)

Controls = Age, age squared, education (3 levels), eastern dummy, age at marriage, age at married squared

1. Highly upwardly mobile (moves up 2 class levels)

2. Upwardly mobile (moves up 1 class level)

3. Immobile (ref.)

4. Downwardly mobile (moves down 1 class level)

5. Highly downwardly mobile (moves down 2 class levels)

```{r, echo=F, message=F, warning=F }

d$long_mobility <- relevel(as.factor(d$long_mobility), ref = "immobile")

m1 <- glm(divorce ~ long_mobility + aage + I(aage^2) + edu + east + agemarr_p1 + I(agemarr_p1^2), family = "binomial", data = filter(d, asex == 1), weights = aweight)
m2 <- glm(divorce ~ long_mobility + aage + I(aage^2) + edu + east + agemarr_p1 + I(agemarr_p1^2), family = "binomial", data = filter(d, asex == 2), weights = aweight)

plot1 <- plot_model(m1, title = "Men", show.values = TRUE, value.offset = .3) +
  scale_x_discrete(labels = list(
    long_mobilitydownward = "Downwardly mobile",
    'long_mobilityhighly downward' = "Highly downwardly mobile",
    'long_mobilityhighly upward' = "Highly upwardly mobile",
    long_mobilityupward = "Upwardly mobile",
    aage = "Age",
    'I(aage^2)' = "Age squared",
    'edupost-secondary or tertiary' = "Edu: Post-seconary or Tertiary",
    'eduupper secondary' = "Edu: Upper secondary",
    'eastWestern EU' = "Western Europe",
    agemarr_p1 = "Age at first marriage",
    'I(agemarr_p1^2)' = "Age at first marraige squared"
  ))

plot2 <- plot_model(m2, title = "Women", show.values = TRUE, value.offset = .3) +
  scale_x_discrete(labels = list(
    long_mobilitydownward = "Downwardly mobile",
    'long_mobilityhighly downward' = "Highly downwardly mobile",
    'long_mobilityhighly upward' = "Highly upwardly mobile",
    long_mobilityupward = "Upwardly mobile",
    aage = "Age",
    'I(aage^2)' = "Age squared",
    'edupost-secondary or tertiary' = "Edu: Post-seconary or Tertiary",
    'eduupper secondary' = "Edu: Upper secondary",
    'eastWestern EU' = "Western Europe",
    agemarr_p1 = "Age at first marriage",
    'I(agemarr_p1^2)' = "Age at first marraige squared"
  ))
ggarrange(plot1, plot2, ncol = 2)



```

## Effect of Long Mobility (5 categories) on Divorce by Sex in Western Europe

```{r, echo=F, message=F, warning=F, fig.width=8}

m3 <- glm(divorce ~ long_mobility + aage + I(aage^2) + edu + agemarr_p1 + I(agemarr_p1^2), family = "binomial", data = filter(d, asex==1 & east=="Western EU"), weights = aweight)

plot3 <- plot_model(m3, title = "Western Europe (Men)", show.values = TRUE, value.offset = .3) +
  scale_x_discrete(labels = list(
    long_mobilitydownward = "Downwardly mobile",
    'long_mobilityhighly downward' = "Highly downwardly mobile",
    'long_mobilityhighly upward' = "Highly upwardly mobile",
    long_mobilityupward = "Upwardly mobile",
    aage = "Age",
    'I(aage^2)' = "Age squared",
    'edupost-secondary or tertiary' = "Edu: Post-seconary or Tertiary",
    'eduupper secondary' = "Edu: Upper secondary",
    'eastWestern EU' = "Western Europe",
    agemarr_p1 = "Age at first marriage",
    'I(agemarr_p1^2)' = "Age at first marraige squared"
  ))

m4 <- glm(divorce ~ long_mobility + aage + I(aage^2) + edu + agemarr_p1 + I(agemarr_p1^2), family = "binomial", data = filter(d, asex == 2 & east == "Western EU"), weights = aweight)

plot4 <- plot_model(m4, title = "Western Europe (Women)", show.values = TRUE, value.offset = .3) +
  scale_x_discrete(labels = list(
    long_mobilitydownward = "Downwardly mobile",
    'long_mobilityhighly downward' = "Highly downwardly mobile",
    'long_mobilityhighly upward' = "Highly upwardly mobile",
    long_mobilityupward = "Upwardly mobile",
    aage = "Age",
    'I(aage^2)' = "Age squared",
    'edupost-secondary or tertiary' = "Edu: Post-seconary or Tertiary",
    'eduupper secondary' = "Edu: Upper secondary",
    'eastWestern EU' = "Western Europe",
    agemarr_p1 = "Age at first marriage",
    'I(agemarr_p1^2)' = "Age at first marraige squared",
    relig = "Religiosity dummy"
  ))

ggarrange(plot3, plot4, ncol = 2)

```


## Effect of Long Mobility (5 categories) on Divorce by Sex in Eastern Europe

```{r, echo=F, message=F, warning=F, fig.width=8}


m5 <- glm(divorce ~ long_mobility + aage + I(aage^2) + edu + agemarr_p1 + I(agemarr_p1^2), family = "binomial", data = filter(d, asex==1 & east=="Eastern EU"))

plot5 <- plot_model(m5, title = "Eastern Europe (Men)", show.values = TRUE, value.offset = .3) + 
  scale_x_discrete(labels = list(
    long_mobilitydownward = "Downwardly mobile",
    'long_mobilityhighly downward' = "Highly downwardly mobile",
    'long_mobilityhighly upward' = "Highly upwardly mobile",
    long_mobilityupward = "Upwardly mobile",
    aage = "Age",
    'I(aage^2)' = "Age squared",
    'edupost-secondary or tertiary' = "Edu: Post-seconary or Tertiary",
    'eduupper secondary' = "Edu: Upper secondary",
    'eastWestern EU' = "Western Europe",
    agemarr_p1 = "Age at first marriage",
    'I(agemarr_p1^2)' = "Age at first marraige squared"
  ))

m6 <- glm(divorce ~ long_mobility + aage + I(aage^2) + edu + agemarr_p1 + I(agemarr_p1^2), family = "binomial", data = filter(d, asex == 2 & east == "Eastern EU"))

plot6 <- plot_model(m6, title = "Eastern Europe (Women)", show.values = TRUE, value.offset = .3) +
  scale_x_discrete(labels = list(
    long_mobilitydownward = "Downwardly mobile",
    'long_mobilityhighly downward' = "Highly downwardly mobile",
    'long_mobilityhighly upward' = "Highly upwardly mobile",
    long_mobilityupward = "Upwardly mobile",
    aage = "Age",
    'I(aage^2)' = "Age squared",
    'edupost-secondary or tertiary' = "Edu: Post-seconary or Tertiary",
    'eduupper secondary' = "Edu: Upper secondary",
    'eastWestern EU' = "Western Europe",
    agemarr_p1 = "Age at first marriage",
    'I(agemarr_p1^2)' = "Age at first marraige squared"
  ))

ggarrange(plot5, plot6, ncol = 2)

```
